[supervisord]
nodaemon=true
user=appuser
logfile=/dev/null
logfile_maxbytes=0

[program:gunicorn]
# Gunicorn serving the Django app on port 10000 with 2 workers
command=uv run gunicorn config.wsgi:application --bind 0.0.0.0:10000 --workers 2 --timeout 120
directory=/app
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:celery]
# Celery worker with concurrency limited to 2 to prevent OOM
command=uv run celery -A config worker --loglevel=info --concurrency=2
directory=/app
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
